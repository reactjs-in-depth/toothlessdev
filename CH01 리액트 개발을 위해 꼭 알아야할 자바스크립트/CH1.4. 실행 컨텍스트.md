# 📖 자바스크립트의 실행 컨텍스트와 호출 스택

스크립트가 로드되거나 함수가 호출될 때마다 새로운 `실행 컨텍스트`가 생성되어 호출 스택 (Call Stack) 에 추가됨

## ✏️ Execution Context 실행 컨텍스트

Execution Context (실행 컨텍스트) 는 `코드가 실행되는 환경을 정의` 하고, <br/>
자바스크립트 엔진이 코드의 `실행 흐름을 추적`하기 위해 사용하는 여러 컴포넌트로 이루어져 있음

### 1️⃣ 소스코드의 평가와 실행

자바스크립트의 소스코드는

> 1. 전역 코드
> 2. 함수 코드
> 3. eval 코드
> 4. 모듈 코드

로 구분되며, 각각은 실행 컨텍스트를 생성하는데 서로 다른 과정으로 생성된다.

#### 1. 소스코드의 평가

소스코드의 평가 과정에서는

> 1. 실행 컨텍스트 생성
> 2. 변수, 함수 등의 선언문을 실행
> 3. 변수나 함수 식별자를 키로 실행 컨텍스트의 스코프에 등록

한다.

#### 2. 소스코드의 실행

소스코드가 순차적으로 실행 (Runtime) 된다.

> 1. 소스코드 실행에 필요한 변수, 함수의 참조를 스코프에서 검색 및 취득
> 2. 변수 값의 변경 등 소스코드의 실행결과는 다시 실행 컨텍스트의 스코프에 등록

### 2️⃣ 실행 컨텍스트 ?

코드가 실행되려면

> 1. 선언에 의해 생성된 모든 식별자의 스코프를 구분하여 등록하고, 상태변화를 지속적으로 관리할 수 있어야 함
> 2. 스코프는 중첩 관계에 있는 스코프 체인을 형성하며, 스코프 체인을 통해 상위 스코프로 이동하며 식별자를 검색할 수 있어야 함
> 3. 현재 실행중인 코드의 실행순서를 변경 하거나, 다시 돌아갈 수 있어야 한다

다음과 같은 기능이 필요한데,
이를 담당하는것이 `실행 컨텍스트` 이다.

> ❗️ 실행 컨텍스트는, 소스코드를 실행하는데 필요한 환경을 제공하고, 코드의 실행 결과를 실제로 관리!

## ✏️ Execution Context 실행 컨텍스트의 구성 요소

### 1️⃣ Realm 영역

코드가 실행되는 고립된 환경으로, <br/>
브라우저에서 탭을 새로 열거나, 페이지를 새로고침할 때마다 새로운 영역이 생성됨.

Realm 은 `전역 객체(Global Object)` 와 `전역 환경 레코드(Global Environment Record)` 같은 여러 컴포넌트를 포함.

1. Global Object (전역 객체)

-   사양 정의 속성 : 자바스크립트의 기본 객체와 함수들(예: Array, Function, SyntaxError 등)
-   호스트 정의 속성 : 브라우저 환경에서 fetch, setTimeout, document와 같은 기능들을 제공
-   사용자 정의 속성 : 전역 범위에서 선언한 함수나 변수를 전역 객체에 추가

2. Global Environment Record (전역 환경 레코드)

-   전역 범위에서 선언된 모든 변수와 함수 바인딩을 관리
-   전역 객체에 직접 연결되며 var 변수와 함수 선언을 관리하는 `객체 레코드 (Object Record)` 와 let, const 키워드로 선언된 변수들을 관리하는 `선언적 레코드 (Declarative Record)`
-   전역 객체를 가리키는 `this`
-   스코프 체인과 연결되는 외부 환경 (Outer Environment)

### 2️⃣ Lexical Environment 렉시컬 환경

> 식별자와, 식별자에 바인딩 된 값, 상위 스코프에 대한 참조를 기록

키-값 을 갖는 객체 형태의 스코프 (전역, 함수, 블록 레벨)를 생성하여, 식별자를 키로 등록하고, 바인딩된 값을 관리함

-   렉시컬 환경은 var 키워드를 제외한 모든 변수 선언을 관리하는 환경 레코드를 가리킴

### 2️⃣ Variable Environment 렉시컬 환경

-   var 키워드로 선언된 변수를 관리함
